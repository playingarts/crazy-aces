<!DOCTYPE html>
<!--
    Crazy Aces - Production Build

    Production Optimizations:
    - All console.log debug statements removed
    - All testing buttons and utilities removed
    - Email validation fully enabled
    - SEO meta tags added
    - Preconnect/DNS-prefetch for external resources
    - CSS performance optimizations (will-change, contain)
    - Deferred script loading
    - Image preloading strategy
    - Error handling and fallbacks
    - LocalStorage for user preferences
    - Cache control headers
    - No TODO/FIXME comments
-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Cache-Control" content="public, max-age=31536000">
    <meta name="description" content="Play Crazy Aces - A fast-paced card game featuring unique artist-designed cards from Playing Arts">
    <meta name="keywords" content="crazy aces, card game, playing cards, playing arts, online card game">
    <meta name="author" content="Playing Arts">
    <meta name="theme-color" content="#1a1a1a">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="https://playingarts.com/favicon.svg">

    <!-- Preconnect to external resources -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://playingarts.com">

    <title>Crazy Aces - Playing Arts</title>
    <!-- EmailJS removed - Email sending now handled server-side via Vercel API -->
    <link rel="stylesheet" href="src/styles/main.css">
    
    <!-- Preload card back for immediate availability -->
    <link rel="preload" as="image" href="https://s3.amazonaws.com/img.playingarts.com/one-small-hd/_backside-evgeny-kiselev.jpg?2" fetchpriority="high">
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <svg class="loading-logo" width="128" height="26" viewBox="0 0 128 26" xmlns="http://www.w3.org/2000/svg" fill="currentColor">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M114.633 21.0497L106.583 13L114.633 4.95038L122.682 13L114.633 21.0497ZM113.345 1.08811L102.721 11.7126C102.01 12.4236 102.01 13.5764 102.721 14.2874L113.345 24.9119C114.056 25.6229 115.209 25.6229 115.92 24.9119L126.545 14.2874C127.256 13.5764 127.256 12.4236 126.545 11.7126L115.92 1.08811C115.209 0.377085 114.056 0.377083 113.345 1.08811ZM80.6667 12.0667C83.7595 12.0667 86.2667 9.55947 86.2667 6.46668C86.2667 3.37388 83.7595 0.866679 80.6667 0.866679C77.5739 0.866679 75.0667 3.37388 75.0667 6.46668C75.0667 9.55947 77.5739 12.0667 80.6667 12.0667ZM88.1333 25.1333C91.2261 25.1333 93.7333 22.6261 93.7333 19.5333C93.7333 16.4406 91.2261 13.9333 88.1333 13.9333C85.0405 13.9333 82.5333 16.4406 82.5333 19.5333C82.5333 22.6261 85.0405 25.1333 88.1333 25.1333ZM78.8 19.5333C78.8 22.6261 76.2928 25.1333 73.2 25.1333C70.1072 25.1333 67.6 22.6261 67.6 19.5333C67.6 16.4406 70.1072 13.9333 73.2 13.9333C76.2928 13.9333 78.8 16.4406 78.8 19.5333ZM53.8945 5.65178L46.8334 18.4031L39.7724 5.65178L53.8945 5.65178ZM48.4464 23.2323C47.7319 24.5226 45.9349 24.5226 45.2204 23.2323L34.9493 4.68404C34.2383 3.40013 35.1333 1.80001 36.5623 1.80001L57.1045 1.80001C58.5336 1.80001 59.4285 3.40013 58.7175 4.68405L48.4464 23.2323ZM5.93897 20.3483L13 7.59693L20.0611 20.3483H5.93897ZM11.387 2.76775C12.1015 1.47744 13.8985 1.47744 14.613 2.76775L24.8841 21.316C25.5951 22.5999 24.7002 24.2 23.2711 24.2H2.72892C1.29988 24.2 0.404947 22.5999 1.11592 21.316L11.387 2.76775Z" style="transition:opacity 1s;opacity:1"></path>
            <path fill-rule="evenodd" clip-rule="evenodd" fill="url(#color)" d="M114.633 21.0497L106.583 13L114.633 4.95038L122.682 13L114.633 21.0497ZM113.345 1.08811L102.721 11.7126C102.01 12.4236 102.01 13.5764 102.721 14.2874L113.345 24.9119C114.056 25.6229 115.209 25.6229 115.92 24.9119L126.545 14.2874C127.256 13.5764 127.256 12.4236 126.545 11.7126L115.92 1.08811C115.209 0.377085 114.056 0.377083 113.345 1.08811ZM80.6667 12.0667C83.7595 12.0667 86.2667 9.55947 86.2667 6.46668C86.2667 3.37388 83.7595 0.866679 80.6667 0.866679C77.5739 0.866679 75.0667 3.37388 75.0667 6.46668C75.0667 9.55947 77.5739 12.0667 80.6667 12.0667ZM88.1333 25.1333C91.2261 25.1333 93.7333 22.6261 93.7333 19.5333C93.7333 16.4406 91.2261 13.9333 88.1333 13.9333C85.0405 13.9333 82.5333 16.4406 82.5333 19.5333C82.5333 22.6261 85.0405 25.1333 88.1333 25.1333ZM78.8 19.5333C78.8 22.6261 76.2928 25.1333 73.2 25.1333C70.1072 25.1333 67.6 22.6261 67.6 19.5333C67.6 16.4406 70.1072 13.9333 73.2 13.9333C76.2928 13.9333 78.8 16.4406 78.8 19.5333ZM53.8945 5.65178L46.8334 18.4031L39.7724 5.65178L53.8945 5.65178ZM48.4464 23.2323C47.7319 24.5226 45.9349 24.5226 45.2204 23.2323L34.9493 4.68404C34.2383 3.40013 35.1333 1.80001 36.5623 1.80001L57.1045 1.80001C58.5336 1.80001 59.4285 3.40013 58.7175 4.68405L48.4464 23.2323ZM5.93897 20.3483L13 7.59693L20.0611 20.3483H5.93897ZM11.387 2.76775C12.1015 1.47744 13.8985 1.47744 14.613 2.76775L24.8841 21.316C25.5951 22.5999 24.7002 24.2 23.2711 24.2H2.72892C1.29988 24.2 0.404947 22.5999 1.11592 21.316L11.387 2.76775Z" style="transition:opacity 1s;opacity:0"></path>
            <defs>
                <linearGradient id="color" x1="18.5985" y1="0.554879" x2="109.834" y2="2.1169" gradientUnits="userSpaceOnUse">
                    <stop stop-color="#82A7F8"></stop>
                    <stop offset="0.5" stop-color="#A6FBF6"></stop>
                    <stop offset="1" stop-color="#CDB0FF"></stop>
                </linearGradient>
            </defs>
        </svg>
        <div class="loading-text">Loading...</div>
    </div>

    <!-- Playing Arts Logo - Always Visible -->
    <a href="https://playingarts.com" target="_blank" rel="noopener noreferrer" class="logo-link">
        <svg class="rules-logo" width="128" height="26" viewBox="0 0 128 26" xmlns="http://www.w3.org/2000/svg" fill="currentColor">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M114.633 21.0497L106.583 13L114.633 4.95038L122.682 13L114.633 21.0497ZM113.345 1.08811L102.721 11.7126C102.01 12.4236 102.01 13.5764 102.721 14.2874L113.345 24.9119C114.056 25.6229 115.209 25.6229 115.92 24.9119L126.545 14.2874C127.256 13.5764 127.256 12.4236 126.545 11.7126L115.92 1.08811C115.209 0.377085 114.056 0.377083 113.345 1.08811ZM80.6667 12.0667C83.7595 12.0667 86.2667 9.55947 86.2667 6.46668C86.2667 3.37388 83.7595 0.866679 80.6667 0.866679C77.5739 0.866679 75.0667 3.37388 75.0667 6.46668C75.0667 9.55947 77.5739 12.0667 80.6667 12.0667ZM88.1333 25.1333C91.2261 25.1333 93.7333 22.6261 93.7333 19.5333C93.7333 16.4406 91.2261 13.9333 88.1333 13.9333C85.0405 13.9333 82.5333 16.4406 82.5333 19.5333C82.5333 22.6261 85.0405 25.1333 88.1333 25.1333ZM78.8 19.5333C78.8 22.6261 76.2928 25.1333 73.2 25.1333C70.1072 25.1333 67.6 22.6261 67.6 19.5333C67.6 16.4406 70.1072 13.9333 73.2 13.9333C76.2928 13.9333 78.8 16.4406 78.8 19.5333ZM53.8945 5.65178L46.8334 18.4031L39.7724 5.65178L53.8945 5.65178ZM48.4464 23.2323C47.7319 24.5226 45.9349 24.5226 45.2204 23.2323L34.9493 4.68404C34.2383 3.40013 35.1333 1.80001 36.5623 1.80001L57.1045 1.80001C58.5336 1.80001 59.4285 3.40013 58.7175 4.68405L48.4464 23.2323ZM5.93897 20.3483L13 7.59693L20.0611 20.3483H5.93897ZM11.387 2.76775C12.1015 1.47744 13.8985 1.47744 14.613 2.76775L24.8841 21.316C25.5951 22.5999 24.7002 24.2 23.2711 24.2H2.72892C1.29988 24.2 0.404947 22.5999 1.11592 21.316L11.387 2.76775Z"></path>
            <path fill-rule="evenodd" clip-rule="evenodd" fill="url(#color2)" d="M114.633 21.0497L106.583 13L114.633 4.95038L122.682 13L114.633 21.0497ZM113.345 1.08811L102.721 11.7126C102.01 12.4236 102.01 13.5764 102.721 14.2874L113.345 24.9119C114.056 25.6229 115.209 25.6229 115.92 24.9119L126.545 14.2874C127.256 13.5764 127.256 12.4236 126.545 11.7126L115.92 1.08811C115.209 0.377085 114.056 0.377083 113.345 1.08811ZM80.6667 12.0667C83.7595 12.0667 86.2667 9.55947 86.2667 6.46668C86.2667 3.37388 83.7595 0.866679 80.6667 0.866679C77.5739 0.866679 75.0667 3.37388 75.0667 6.46668C75.0667 9.55947 77.5739 12.0667 80.6667 12.0667ZM88.1333 25.1333C91.2261 25.1333 93.7333 22.6261 93.7333 19.5333C93.7333 16.4406 91.2261 13.9333 88.1333 13.9333C85.0405 13.9333 82.5333 16.4406 82.5333 19.5333C82.5333 22.6261 85.0405 25.1333 88.1333 25.1333ZM78.8 19.5333C78.8 22.6261 76.2928 25.1333 73.2 25.1333C70.1072 25.1333 67.6 22.6261 67.6 19.5333C67.6 16.4406 70.1072 13.9333 73.2 13.9333C76.2928 13.9333 78.8 16.4406 78.8 19.5333ZM53.8945 5.65178L46.8334 18.4031L39.7724 5.65178L53.8945 5.65178ZM48.4464 23.2323C47.7319 24.5226 45.9349 24.5226 45.2204 23.2323L34.9493 4.68404C34.2383 3.40013 35.1333 1.80001 36.5623 1.80001L57.1045 1.80001C58.5336 1.80001 59.4285 3.40013 58.7175 4.68405L48.4464 23.2323ZM5.93897 20.3483L13 7.59693L20.0611 20.3483H5.93897ZM11.387 2.76775C12.1015 1.47744 13.8985 1.47744 14.613 2.76775L24.8841 21.316C25.5951 22.5999 24.7002 24.2 23.2711 24.2H2.72892C1.29988 24.2 0.404947 22.5999 1.11592 21.316L11.387 2.76775Z" style="opacity:0"></path>
            <defs>
                <linearGradient id="color2" x1="18.5985" y1="0.554879" x2="109.834" y2="2.1169" gradientUnits="userSpaceOnUse">
                    <stop stop-color="#82A7F8"></stop>
                    <stop offset="0.5" stop-color="#A6FBF6"></stop>
                    <stop offset="1" stop-color="#CDB0FF"></stop>
                </linearGradient>
            </defs>
        </svg>
    </a>

    <!-- Version Display -->
    <div class="version-display" id="versionDisplay">
        <span id="versionText">v...</span>
    </div>

    <!-- Rules Box -->
    <div class="rules-box" id="rulesBox">
        <div class="rules-content">
            <h3>Crazy Aces - How to Play:</h3>
            <ul>
                <li>Match the suit or rank of the top card</li>
                <li>Aces are wild—choose any suit</li>
                <li>Jokers let you play any card immediately</li>
                <li>Can't play? Draw a card</li>
                <li>First to empty your hand wins</li>
            </ul>
        </div>

        <button class="rules-ok-btn" data-action="hide-rules">OK</button>
    </div>

    <div class="confetti-container" id="confettiContainer"></div>

    <!-- Opponent hand - fixed position, separate from game flow -->
    <div class="opponent-hand-section">
        <div class="opponent-hand-preview" id="opponentHandPreview">
            <!-- Card backs will be generated here -->
        </div>
    </div>

    <div class="game-container">
        <div class="play-area">
            <div class="deck-pile" data-action="draw-card">
                <div class="card card-back" id="deckCard"></div>
                <div class="card-artist" id="deckHint" style="margin-top: 8px; display: none;">Draw a card</div>
            </div>

            <div class="discard-pile" id="discardPile">
                <div class="card" id="topCard">
                    <!-- Top discard card -->
                </div>
                <div class="card-stack" id="cardStack">
                    <!-- Previous cards stack here -->
                </div>
            </div>
        </div>

        <div class="player-hand-section">
            <div class="status-message" id="statusMessage">
                Loading game...
            </div>
            <div class="player-hand">
                <div class="hand-cards" id="playerHand">
                    <!-- Player cards will be generated here -->
                </div>
            </div>
        </div>
    </div>

    <div class="suit-selector-overlay" id="suitSelectorOverlay"></div>
    <div class="suit-selector" id="suitSelector">
        <div class="suit-selector-header">
            <div class="suit-selector-title">Choose a suit</div>
        </div>
        <div class="suit-options">
            <div class="suit-option" id="suit-spades" data-action="choose-suit" data-param="♠">♠</div>
            <div class="suit-option" id="suit-hearts" data-action="choose-suit" data-param="♥">♥</div>
            <div class="suit-option" id="suit-clubs" data-action="choose-suit" data-param="♣">♣</div>
            <div class="suit-option" id="suit-diamonds" data-action="choose-suit" data-param="♦">♦</div>
        </div>
    </div>

    <div class="game-over-overlay" id="gameOverOverlay"></div>

    <div class="game-over" id="gameOver">
        <div class="game-over-icon" id="gameOverIcon"></div>
        <div class="game-over-top">
            <div class="result-text" id="resultText"></div>

            <!-- Play More button (shown on win, right after title) -->
            <button class="play-more-btn" id="playMoreBtn" data-action="play-more" style="display: none;">Play More</button>

            <!-- Regular Play Again button (shown on loss or after claiming) -->
            <button class="play-again-btn" id="playAgainBtn" data-action="play-again" style="display: none;">Play Again</button>
        </div>

        <!-- Discount section combined with wins info (shown on win) -->
        <div class="discount-section" id="discountSection" style="display: none;">
            <div class="discount-text" id="discountText"></div>
            <div class="discount-info" id="discountInfo">
                <div id="milestone1"><span class="milestone-icon unchecked">⬜</span> Play 1 game → 5% Welcome Bonus</div>
                <div id="milestone2"><span class="milestone-icon unchecked">⬜</span> Win 1 game → 10% Winner Bonus</div>
                <div id="milestone3"><span class="milestone-icon unchecked">⬜</span> Win 2+ games in a row → 15% Champion Bonus</div>
                <div class="discount-note">Redeem your discount for <a href="https://playingarts.com/shop" target="_blank">Playing Arts decks</a></div>
            </div>

            <!-- Claim buttons container (shown initially) -->
            <div class="discount-buttons-container" id="discountButtonsContainer" style="display: flex;">
                <button class="claim-discount-btn-small" id="claimBtn" data-action="show-email-form">
                    Claim <span id="claimPercent">0</span>% discount now
                </button>
                <button class="play-more-btn-small" id="playMoreBtnSmall" data-action="play-to-get-discount">
                    Play more to get <span id="playMorePercent">10</span>%
                </button>
            </div>

            <!-- Email form (shown when Claim is clicked, replaces button) -->
            <div class="email-form-inline" id="emailFormInline" style="display: none;">
                <form data-action="email-form">
                    <input type="email" id="emailInput" class="email-input" placeholder="your@email.com" />
                    <div class="email-error" id="emailError"></div>
                    <div class="email-form-buttons">
                        <button type="submit" class="send-email-btn" id="sendDiscountBtn" data-action="send-discount">Send Discount</button>
                        <button type="button" class="cancel-email-btn" data-action="hide-email-form">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Debug buttons (bottom right corner) -->
    <div class="debug-buttons" id="debugButtons">
        <button id="debugWin" class="debug-btn win">win</button>
        <button id="debugLose" class="debug-btn lose">lose</button>
    </div>

    <script type="module" src="src/js/main.js"></script>
</body>
</html>
